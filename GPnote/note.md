# 20180304

졸작으로 라파와 서버 DB간의 통신을 해주는 와중에 방화벽 문제로 라파에서 서버 DB에 접근 및 접속이 되지 않았다.<br>

이를 해결 하기 위해선 서버에 고정 IP를 할당하고 포트 포워딩을 해주어야 했다.<br>

같은 와이파이를 계속 통신하면 되지만 라파에서도 계속 같은 와이파이를 사용할 수 있으리라는 보장이 없으므로 포트 포워딩은 필수적이었다.<br>

서버 컴퓨터는 교내 와이파이로 인터넷 통신을 하고 있었는데 고정 IP가 아니고 포트가 외부에서 접근할 때 달라질 수 있는<br>

문제점이 있었다.<br>

이로 인해 서버 컴퓨터와 공유기에 유선 랜을 연결하여 고정 IP를 할당해주고<br>

공유기 관리페이지에서 포트 포워딩 또한 허용해주도록 했다.<br>

그리고 라파에서 서버의 DB로 접근할 때의 방법에서도 조언을 받았다. <br>

1. 기존에는 바로 DB에 접속하여 쿼리문을 날려주려고 하였다.<br>

그러나 이와 같은 방법이 보안적으로 취약하다는 지적을 받고<br>

2. 클라이언트 페이지에서 http Request를 서버로 날려 이를 통해 쿼리문을 날려주도록 하는 것이 낫다<br>

는 방법을 또한 착안하였다. 두 가지 방법 모두 시도를 해봐야겠다.<br>

# 20180306

우분투에 고정 ip를 잡는게 잘 안된다. 공유기도 인터넷에 흔히 나와있는 것들과 버젼이 달라 ip설정을 해주는게 헷갈린다.

# 20180306

3일간에 삽질을 한 끝에 우분투에 인터넷을 연결할 수 있었다..감동 ㅠㅠ <br>

라즈베리파이가 교내 와이파이에 연결된 상태에서 랩실 서버에 연결시켜주려고 하였다. 이를 위해선 서버 ip가 고정되어야 하고 포트포워딩이 되어야 한다고<br>

생각했다. 이를 위해서 진행할 때 아래 블로그 에서 제시된대로 따라하였다.<br>

http://abc1211.tistory.com/289

그런데 블로그랑 달리 공유기 버젼이 다르고 ip 설정이 dhcp(유/무선 자동할당)으로만 되었다.<br>

이를 해결하기 위해서 교수님께 여쭤보니 그렇게 하면 안된다고 하셨다.<br>

첫번 째로 스위칭 허브가 있어야 하고<br>

두번 째로 랩실 공유기는 단순히 사설 네트워크를 분배하는 것밖에 되지 않음.<br>

랩실에 들어오는 랜선 3개 중 하나를 직접 물려보라고 하셨다.<br>

그리하여 연구원님께 받은 ip 리스트 중 하나를 선정해 사용하였다.<br>

여기까지에서 블로그에서 제시한 방법이 안된 이유를 정리해보면<br>

1. 블로그에서 사용한 공유기 버젼과 내 공유기 버젼은 서로 다름(내껀 A6004NS-M)<br>

2. 랩실 공유기는 스위칭 허브 기능이 제공되지 않음<br>

3. 블로그에선 외부 네트워크 ip 하나를 공유기에 할당시키고 여기서 동적 ip 주소를 각각 받아서 사용. 아무래도 블로거의 회사 공유기는<br>

스위칭 허브 기능을 겸한 것이지 않을까..? 내부 네트워크에서 하나를 고정 ip로 하여 포트 포워딩을 시켜줌.<br>

하지만 내가 속한 교내 네트워크의 경우는 학부마다 네트워크들이 있고 할당되는 ip들이 있다. 또 랩실마다 부여받은 ip 대역이 있고 랩실의 공유기는<br>

할당받은 ip 하나를 잡아서 dhcp 방식으로 유/무선 네트워크를 제공한다. 정확히 정리는 안되었지만 블로거의 회사 네트워크와 교내 네트워크는 범위와 영역이 다른 것 같다.<br>

아무튼 ip를 하나 잡아서 우분투에 설정해주었는데 인터넷 연결이 되지 않았다. 우분투에서 고정 ip를 설정하는 방법이 여러가지라 제시되는 방법들을 모두 시도해보았고<br>

설정이 겹치는 문제일수도 있다고 생각하여 포맷도 여러번 하며 다시 해보았지만 해결이 되지 않았다.<br>

그래서 이를 해결하기 위해 종훈이 한테 물어보았다. 처음엔 우분투 network manager로 ip 설정과 gateway, dns 등 설정을 해주었다. 이게<br>

우분투에서 1순위로 실행이 되는 것이라 여기에 설정을 해주는 것이 맞는데 연결이 안되었다. 종훈이가 보더니 ping google.com 으로 인터넷 연결을 확인하였고 이 후<br>

ip는 설정이 되었는데 dns 서버가 설정이 안되었다고 얘기하였다. dns는 network manager로 설정을 해주었는데 제대로 설정이 안된 것 같다.<br>

아래와 같이 입력하며<br>

```
cat /etc/resolv.conf
```

로 127.0.0.1 으로 된 dns 설정을 구글 도메인인 8.8.8.8 로 설정해주었다.<br>

그랬더니 처음 설정할 때는 인터넷 연결이 잘 되었지만 재부팅을 하기 해당 설정이 초기화가 되었다.<br>

이를 해결해주기 위해서 종훈이가 띄워준 링크(http://wani.kr/posts/2017/03/22/ubuntu-resolvconf-settings-summary/)에 따라서 tail 이란 파일을 만들어 dns 서버를 입력해주었다.<br>

아래와 같이<br>

```
nano /etc/resolvconf/resolv.conf.d/tail
```

입력해 도메인 서버를 입력해준다.<br>

그렇게 해주니 재부팅을 하여도 dns 서버 값이 초기화 되지 않고 유지되었다. 그리고 인터넷 연결도 잘 되었다. 처음에는 8.8.8.8 로 입력하고 연결 확인 후에<br>

교내 dns 서버도 입력해주었다. 교내 dns 서버를 입력해도 인터넷 연결이 잘 되었다.<br>

또 포트 포워딩이 되는지 확인하기 위해 라즈베리파이를 교내 네트워크 KUTAP_N 에 연결한 상태에서 랩실 ip에 ping을 날려보니 서로 통신이 되는 것을 확인할 수 있었다.<br>
